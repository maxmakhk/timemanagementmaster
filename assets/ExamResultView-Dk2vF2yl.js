import{_ as C,u as I,f as N,c as i,a as e,t as s,b as d,l as S,F as P,i as A,r as o,e as E,k as B,o as c,n as f}from"./index-BJxI1--x.js";const F={class:"exam-result-view"},J={class:"exam-header"},O={key:0,class:"exam-subtitle"},V={key:0,class:"exam-container"},q={class:"overall-status"},L={class:"status-icon"},M={class:"status-text"},Q={class:"pass-rate-section"},z={class:"pass-rate"},T={class:"rate-label"},j={class:"rate-value"},G={class:"rate-percentage"},H={key:0,class:"failure-note"},K={class:"exam-desc"},U={class:"skills-section"},W={class:"skills-grid"},X={class:"skill-header"},Y={class:"skill-name"},Z={class:"skill-details"},ee={class:"detail-row"},se={class:"detail-label"},ae={class:"detail-value"},te={class:"detail-row"},le={class:"detail-label"},ne={class:"detail-value"},oe={class:"progress-section"},re={class:"progress-label"},ie={class:"progress-bar"},ce={key:0,class:"random-chance"},ue={class:"chance-label"},de={class:"chance-value"},ve={class:"reward-section"},me={class:"reward-card"},_e={class:"reward-row"},pe={class:"reward-label"},he={class:"reward-value original"},ge={key:0,class:"reward-row"},xe={class:"reward-label"},we={class:"reward-reduction"},fe={class:"reward-row final"},ye={class:"reward-label"},be={class:"reward-value final"},Se={class:"action-buttons"},De={__name:"ExamResultView",setup($e){const v=E(),{t:y}=I(),n=o(null),t=o(null),b=o([]),r=o(!1),m=o(0),g=o(3),x=o(1),u=o(null),_=o(0),p=o(0);N(()=>{const a=sessionStorage.getItem("examData"),h=sessionStorage.getItem("simulationData");a?(n.value=JSON.parse(a),t.value=JSON.parse(h),u.value=n.value.currentNPC,x.value=n.value.examAttempt||1,b.value=n.value.skillResults||[],r.value=n.value.passed||!1,m.value=n.value.passedSkills||0,_.value=n.value.originalReward||0,p.value=n.value.finalReward||0):v.push("/time-management/schedule")});const D=B(()=>Math.round(m.value/g.value*100)),$=()=>{if(t.value&&n.value&&u.value){const a=n.value.requiredDays,h=u.value.id;t.value.currentDay=a,t.value.examAttempt=(t.value.examAttempt||1)+1,t.value.extendedDays=t.value.extendedDays||{},t.value.extendedDays[h]=a+5,sessionStorage.setItem("simulationData",JSON.stringify(t.value)),sessionStorage.removeItem("examData"),v.push("/time-management/schedule")}},k=()=>{t.value&&n.value&&(t.value.currentNPCIndex=(t.value.currentNPCIndex||0)+1,t.value.currentDay=0,t.value.examAttempt=1,n.value.questIndex>=0&&(t.value.completedQuests=t.value.completedQuests||[],t.value.completedQuests.push({id:u.value.id,reward:p.value,passed:r.value})),sessionStorage.setItem("simulationData",JSON.stringify(t.value)),sessionStorage.removeItem("examData"),t.value.currentNPCIndex<t.value.selectedNPCs.length?v.push("/time-management/schedule"):v.push("/time-management/report"))},w=a=>a.passed?"#2ecc71":"#e74c3c",R=a=>a.passed?y("exam.pass"):y("exam.fail");return(a,h)=>(c(),i("div",F,[e("header",J,[e("h1",null,s(a.$t("exam.title")),1),u.value?(c(),i("p",O,s(u.value.name)+" - "+s(a.$t("exam.attempt"))+" #"+s(x.value),1)):d("",!0)]),n.value?(c(),i("div",V,[e("div",{class:S(["result-card",{passed:r.value,failed:!r.value}])},[e("h2",null,s(a.$t("exam.overallResult")),1),e("div",q,[e("div",L,s(r.value?"✓":"✗"),1),e("div",M,s(r.value?a.$t("exam.passed"):a.$t("exam.failed")),1)]),e("div",Q,[e("div",z,[e("span",T,s(a.$t("exam.passRate")),1),e("span",j,s(m.value)+" / "+s(g.value),1),e("span",G,"("+s(D.value)+"%)",1)])]),r.value?d("",!0):(c(),i("p",H,s(g.value-m.value)+" "+s(a.$t("exam.skillsFailed")),1)),e("p",K,s(a.$t("exam.examDescription")),1)],2),e("div",U,[e("h2",null,s(a.$t("exam.skillBreakdown")),1),e("div",W,[(c(!0),i(P,null,A(b.value,l=>(c(),i("div",{key:l.name,class:"skill-card",style:f({borderColor:w(l)})},[e("div",X,[e("h3",Y,s(l.emoji)+" "+s(l.name),1),e("span",{class:"skill-status",style:f({backgroundColor:w(l)})},s(R(l)),5)]),e("div",Z,[e("div",ee,[e("span",se,s(a.$t("exam.currentLevel")),1),e("span",ae,s(l.current),1)]),e("div",te,[e("span",le,s(a.$t("exam.goalLevel")),1),e("span",ne,s(l.goal),1)])]),e("div",oe,[e("div",re,s(a.$t("exam.progress"))+": "+s(l.percentage)+"%",1),e("div",ie,[e("div",{class:"progress-fill",style:f({width:Math.min(l.percentage,100)+"%",backgroundColor:w(l)})},null,4)])]),!l.passed&&l.percentage>0&&l.percentage<100?(c(),i("div",ce,[e("span",ue,s(a.$t("exam.randomChance")),1),e("span",de,s(l.percentage)+"%",1)])):d("",!0)],4))),128))])]),e("div",ve,[e("h2",null,s(a.$t("exam.examScore")),1),e("div",me,[e("div",_e,[e("span",pe,s(a.$t("exam.originalReward")),1),e("span",he,s(_.value)+" Reputation",1)]),x.value>1?(c(),i("div",ge,[e("span",xe,s(a.$t("exam.rewardReduction")),1),e("span",we,"-"+s(((_.value-p.value)/_.value*100).toFixed(0))+"%",1)])):d("",!0),e("div",fe,[e("span",ye,s(a.$t("exam.rewardAfterDeduction")),1),e("span",be,s(p.value)+" Reputation",1)])])])])):d("",!0),e("div",Se,[r.value?d("",!0):(c(),i("button",{key:0,onClick:$,class:"btn btn-retry"},s(a.$t("exam.retryExam")),1)),e("button",{onClick:k,class:S(["btn","btn-next",{"btn-primary":r.value}])},s(a.$t("exam.nextStudent")),3)])]))}},Re=C(De,[["__scopeId","data-v-2b1dd11a"]]);export{Re as default};
